@echo off
title MalwareDiagnosticv0.1

:: Check for admin rights
net session >nul 2>&1
if %errorLevel% neq 0 (
    echo.
    echo *** This script requires Administrator privileges. ***
    echo Please allow the UAC prompt to run as Administrator.
    echo.
    powershell -Command "Start-Process '%~f0' -Verb runAs"
    exit /b
)

:MENU
cls
echo ================================
echo      MalwareDiagnostic v0.1
echo ================================
echo.
echo 1. Run Windows Defender Quick Scan
echo 2. Run Windows Defender Full Scan
echo 3. Exit
echo.
set /p choice=Choose an option (1-3): 

if "%choice%"=="1" goto QuickScan
if "%choice%"=="2" goto FullScan
if "%choice%"=="3" goto Exit
echo Invalid choice, please try again.
pause
goto MENU

:QuickScan
cls
echo Running Windows Defender Quick Scan...
echo.

powershell -Command ^
"Try { ^
    $svc = Get-Service WinDefend; ^
    if ($svc.Status -ne 'Running') { Start-Service WinDefend; Start-Sleep -Seconds 2 } ^
    Write-Host 'Starting Quick Scan...'; ^
    Start-MpScan -ScanType Quick; ^
    Write-Host 'Quick Scan completed successfully.' ^
} Catch { ^
    Write-Host 'Error:' $_.Exception.Message ^
}"

echo.
pause
goto MENU

:FullScan
cls
echo Running Windows Defender Full Scan...
echo.

powershell -Command ^
"Try { ^
    $svc = Get-Service WinDefend; ^
    if ($svc.Status -ne 'Running') { Start-Service WinDefend; Start-Sleep -Seconds 2 } ^
    Write-Host 'Starting Full Scan... This may take a long time.'; ^
    Start-MpScan -ScanType Full; ^
    Write-Host 'Full Scan completed successfully.' ^
} Catch { ^
    Write-Host 'Error:' $_.Exception.Message ^
}"

echo.
pause
goto MENU

:Exit
echo Exiting MalwareDiagnosticv0.1...
exit /b
